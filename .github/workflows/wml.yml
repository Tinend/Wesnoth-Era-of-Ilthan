name: WML
on: [push, pull_request]

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
    - name: Check out the repository
      uses: actions/checkout@v4

    - name: Clone Wesnoth 1.18 branch data/ directory
      run: |
        git clone --no-checkout https://github.com/wesnoth/wesnoth.git
	cd wesnoth
	git sparse-checkout init
	git sparse-checkout set data
	git checkout 1.18
	

    - name: Run wmllint
      run: |
        wesnoth/data/tools/wmllint -S -d wesnoth/data/core . | grep -v wesnoth/

    - name: Run wmlindent
      run: |
        wesnoth/data/tools/wmlindent -d .

    - name: Run wmlscope
      run: |
        wesnoth/data/tools/wmlscope -d wesnoth/data/core . | grep -v wesnoth/
